<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Lukas Woodtli - C</title>
        <link rel="stylesheet" href="http://lukaswoodtli.github.io/theme/css/main.css" />

        <!--[if IE]>
            <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="http://lukaswoodtli.github.io/">Lukas Woodtli </a></h1>
                <nav><ul>
                    <li><a href="/index.html">Home</a></li>
                    <li><a href="/pages/resume.html">Resume</a></li>
                    <li><a href="[(u'Hard Skills', u'/pages/skills.html'), (u'Courses', u'/pages/courses.html'), (u'Books', u'/pages/books.html'), (u'Projects', u'/pages/projects.html')]">Skills</a></li>
                    <li><a href="[(u'Blog Index', u'/pages/blog.html'), (u'Categories', u'/categories.html'), (u'Tags', u'/tags.html'), (u'Chronological', u'/archives.html')]">Blog</a></li>
                    <li><a href="/pages/contact.html">Contact</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/blog.html">Blog</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/books.html">Books</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/contact.html">Contact</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/courses.html">Courses</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/note_to_recruiters_and_headhunters.html">Note to Recruiters and&nbsp;Headhunters</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/projects.html">Projects</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/resume.html">Resume</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/pages/skills.html">Skills</a></li>
    
                        <li><a href="http://lukaswoodtli.github.io/">Welcome to my&nbsp;Site</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/emacs.html">Emacs</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/finance.html">Finance</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/mathematics.html">Mathematics</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/misc.html">Misc</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/programming.html">Programming</a></li>
                    <li><a href="http://lukaswoodtli.github.io/category/version_control.html">Version Control</a></li>
                </ul>
                </nav>
        </header><!-- /#banner -->

            <aside id="featured" class="body">
                <article>
                    <h1 class="entry-title"><a href="http://lukaswoodtli.github.io/sanitizers.html">Sanitizers</a></h1>
<footer class="post-info">
        <span>Mon 05 March 2018</span>
<span>| tags: <a href="http://lukaswoodtli.github.io/tag/c.html">C</a><a href="http://lukaswoodtli.github.io/tag/cpp.html">C++</a><a href="http://lukaswoodtli.github.io/tag/dynamic_analysis.html">Dynamic Analysis</a></span>
</footer><!-- /.post-info --><h1 id="sanitizers">Sanitizers</h1>
<h2 id="address-sanitizer-and-leak-sanitizer">Address Sanitizer (and Leak Sanitizer)</h2>
<p>Compile and link with the flag <code>-fsanitize=address</code>
It might be necessary to link with <code>-lasan</code> with older gcc/ld versions.</p>
<h3 id="run-time-flags">Run-time flags</h3>
<p>Flags for the sanitizers can be provided with the <code>ASAN_OPTIONS</code> and <code>LSAN_OPTIONS</code> environment variables. They take a colon (<code>:</code>) separated list and should be exported in the environment, before running a sanatized executable.</p>
<h3 id="leak-sanitizer-and-additional-checks">Leak Sanitizer and Additional Checks</h3>
<p>The Leak Sanitizer can be enabled in ASan by setting <code>ASAN_OPTIONS=detect_leaks=1</code>. This is not needed on Linux as it is enabled by default.</p>
<p>Find dynamic initialization order problems (only on Linux):
<code>ASAN_OPTIONS=check_initialization_order=1</code></p>
<p>To find memory use after return add <code>ASAN_OPTIONS=detect_stack_use_after_return=1</code>.</p>
<p>To check for memory use after scope the compiler flag (not runtime oprion) <code>-fsanitize-address-use-after-scope</code> can be used.</p>
<h3 id="symbolizing-output">Symbolizing output</h3>
<p>To see nice call stacks with readable symbols when the sanitizer finds a problem a symbolizer might be needed.</p>
<p>Add this to the sanitizer runtime flags:</p>
<p><code>ASAN_OPTIONS=symbolize=1</code></p>
<p>and the path to the symbolizer</p>
<p><code>ASAN_SYMBOLIZER_PATH=/usr/local/bin/llvm-symbolizer</code></p>
<p>also the compiler flag to not omit the frame pointer can help: <code>-fno-omit-frame-pointer</code></p>
<h3 id="preloading">Preloading</h3>
<p>In some cases the sanitizer library needs to be preloaded to an executable. Especially if other libraries are preloaded. Then the sanitizer library needs to be first in the list of preloaded libraries:</p>
<p><code>LD_PRELOAD=libasan.so.3:libmylib.dso:$LD_PRELOAD ./myexecutable</code></p>
<p>Note that the version of the sanitizer library (e.g. <code>libasan.so.3</code>) needs to be provided if there is no symbolic link <code>libasan.so</code> that points to the right version.</p>
<p>To find out the right library name (and the path) one can run
<code>ldd path/to/an/executable | grep libasan</code>
on an executable that was built with the <code>-fsanitize=address</code> flag</p>
<p>For debugging problems with <code>LD_PRELOAD</code> setting the environment variable <code>LD_DEBUG=libs</code> might help. It shows which <span class="caps">DSO</span> is loaded from which directory and the order of loading the <span class="caps">DSO</span>’s.</p>
<h3 id="custom-signal-handlers">Custom Signal Handlers</h3>
<p>If an executable uses custom signal handlers then the signal handlers of ASan need to be disabled:</p>
<p><code>ASAN_OPTIONS="allow_user_segv_handler=1:handle_segv=0:handle_abort=0:handle_sigfpe=0"</code></p>
<h3 id="suppressions">Suppressions</h3>
<p>To suppress detection of concrete leaks foud by LSan a suppression file can be provided</p>
<p><code>LSAN_OPTIONS="suppressions=$(realpath lsan_suppressions.txt)"</code></p>
<p>Example of <code>lsan_suppressions.txt</code></p>
<div class="highlight"><pre><span></span><span class="n">leak</span><span class="o">:</span><span class="n">FooBar</span>
<span class="n">leak</span><span class="o">:</span><span class="n">libmylibrary</span><span class="o">.</span><span class="na">so</span>
<span class="n">leak</span><span class="o">:</span><span class="n">myexecutable</span>
</pre></div>
<p>There is also a similar suppression mechanism for ASan.</p>
<h3 id="help-and-debugging">Help and Debugging</h3>
<p>It’s possible to print debug information when using the sanitizer. Also the verbosity
of any output can be increased.</p>
<p><code>ASAN_OPTIONS="verbosity=2:debug=1:help=1"</code></p>
<p>For getting help </p>
<p><code>ASAN_OPTIONS="help=1"</code></p>                </article>
            </aside><!-- /#featured -->
                <section id="content" class="body">
                    <h1>Other articles</h1>
                    <ol id="posts-list" class="hfeed">

            <li><article class="hentry">
                <header>
                    <h1><a href="http://lukaswoodtli.github.io/gcc_binutils_and_other_developer_tools.html" rel="bookmark"
                           title="Permalink to GCC, binutils and other developer tools"><span class="caps">GCC</span>, binutils and other developer&nbsp;tools</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Thu 22 February 2018</span>
<span>| tags: <a href="http://lukaswoodtli.github.io/tag/c.html">C</a><a href="http://lukaswoodtli.github.io/tag/cpp.html">C++</a><a href="http://lukaswoodtli.github.io/tag/os.html">OS</a><a href="http://lukaswoodtli.github.io/tag/linux.html">Linux</a></span>
</footer><!-- /.post-info -->                <blockquote>
<p>Work in Progress!</p>
</blockquote>
<h1 id="ld">ld</h1>
<h2 id="flags">Flags</h2>
<ul>
<li><code>-z now</code></li>
<li><code>-O1</code> (linker!)</li>
</ul>
<h2 id="environment-variables">Environment Variables</h2>
<ul>
<li><code>LD_BIND_NOW</code></li>
<li><code>LD_PRELOAD</code></li>
<li><code>LD_DEBUG</code></li>
<li><code>LD_DEBUG_OUTPUT</code></li>
</ul>
<p>ld/gcc?</p>
<p><code>--hash-style=gnu</code></p>
<h1 id="readelf">readelf</h1>
<h2 id="show-which-libraries-have-been-linked">Show which libraries have been linked</h2>
<p><code>readelf -a &lt;prog&gt; | grep "Shared library"</code></p>
<h2 id="show-the-run-time-linker">Show the run-time linker</h2>
<p><code>readelf -a &lt;prog&gt; | grep "program interpreter"</code></p>
<h1 id="objdump">objdump</h1>
<h2 id="flags_1">Flags</h2>
<ul>
<li><code>-d</code>: disassemble</li>
<li><code>-C</code>: demangle C++ symbols …</li></ul>
                <a class="readmore" href="http://lukaswoodtli.github.io/gcc_binutils_and_other_developer_tools.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://lukaswoodtli.github.io/preprocessor_defines.html" rel="bookmark"
                           title="Permalink to Preprocessor Defines">Preprocessor&nbsp;Defines</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Sat 01 August 2015</span>
<span>| tags: <a href="http://lukaswoodtli.github.io/tag/c.html">C</a><a href="http://lukaswoodtli.github.io/tag/cpp.html">C++</a></span>
</footer><!-- /.post-info -->                <h1 id="preprocessor-defines">Preprocessor Defines</h1>
<p>This page lists commonly used preprocessor defines for C/C++</p>
<h2 id="programming-language">Programming Language</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Language</th>
<th>Define</th>
</tr>
</thead>
<tbody>
<tr>
<td>C++</td>
<td><code>__cplusplus</code></td>
</tr>
<tr>
<td>C 99</td>
<td><code>__STDC__</code></td>
</tr>
</tbody>
</table>
<h2 id="compiler">Compiler</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Compiler</th>
<th>Define</th>
</tr>
</thead>
<tbody>
<tr>
<td><span class="caps">GNU</span></td>
<td><code>__GNUC__</code></td>
</tr>
<tr>
<td>Visual Studio</td>
<td><code>_MSC_VER_</code></td>
</tr>
</tbody>
</table>
<h2 id="processor">Processor</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Processor</th>
<th>Defines</th>
</tr>
</thead>
<tbody>
<tr>
<td>x86</td>
<td><code>_M_IX86</code>, <code>__INTEL__</code>, <code>__i386__</code></td>
</tr>
<tr>
<td>x86-64</td>
<td><code>_M_X64</code>, <code>__x86_64__</code></td>
</tr>
<tr>
<td><span class="caps">IA64</span></td>
<td><code>_IA64__</code></td>
</tr>
</tbody>
</table>
<h2 id="endianness">Endianness</h2>
<table class="table table-striped">
<thead>
<tr>
<th>Byte Order</th>
<th>Define</th>
</tr>
</thead>
<tbody>
<tr>
<td>Little Endian</td>
<td><code>__LITTLE_ENDIAN__</code></td>
</tr>
<tr>
<td>Big Endian …</td></tr></tbody></table>
                <a class="readmore" href="http://lukaswoodtli.github.io/preprocessor_defines.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://lukaswoodtli.github.io/arrays_in_c_and_cpp.html" rel="bookmark"
                           title="Permalink to Arrays in C and C++">Arrays in C and&nbsp;C++</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Wed 15 July 2015</span>
<span>| tags: <a href="http://lukaswoodtli.github.io/tag/c.html">C</a><a href="http://lukaswoodtli.github.io/tag/cpp.html">C++</a></span>
</footer><!-- /.post-info -->                <p>Arrays are simple but quite powerful constructs in C/C++.
They are merely a representation of consecutive data in memory.</p>
<p>They don’t contain any meta data (like size). But since they are
stored in memory in such a simple manner processors can handle
them very efficiently.</p>
<div class="highlight"><pre><span></span><span class="c1">//     rows  columns</span>
<span class="c1">//        |  |   </span>
<span class="c1">//        v …</span></pre></div>
                <a class="readmore" href="http://lukaswoodtli.github.io/arrays_in_c_and_cpp.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>

            <li><article class="hentry">
                <header>
                    <h1><a href="http://lukaswoodtli.github.io/endianness.html" rel="bookmark"
                           title="Permalink to Endianness">Endianness</a></h1>
                </header>

                <div class="entry-content">
<footer class="post-info">
        <span>Wed 17 June 2015</span>
<span>| tags: <a href="http://lukaswoodtli.github.io/tag/c.html">C</a><a href="http://lukaswoodtli.github.io/tag/cpp.html">C++</a></span>
</footer><!-- /.post-info -->                <p>The endianness means the representation of a variable (if it is bigger than one byte) in the memory.</p>
<blockquote>
<p>Big-Endian: Most Significant Byte (<span class="caps">MSB</span>) is first (bigger end is first)</p>
<p>Little Endian: Least Significant Byte (<span class="caps">LSB</span>) is first (little end is first)</p>
</blockquote>
<p><img alt="Big-Endian and Little-Endian" class="img-fluid" src="/images/endianness.png"/></p>
<h1 id="cpus"><span class="caps">CPU</span>’s</h1>
<h2 id="big-endian">Big-Endian:</h2>
<ul>
<li>Motorola-6800</li>
<li>Motorola-68k</li>
<li>Coldfire</li>
<li>System-z</li>
<li>Sun-<span class="caps">SPARC …</span></li></ul>
                <a class="readmore" href="http://lukaswoodtli.github.io/endianness.html">read more</a>
                </div><!-- /.entry-content -->
            </article></li>
            </ol><!-- /#posts-list -->
<p class="paginator">
    Page 1 / 2
        <a href="http://lukaswoodtli.github.io/tag/c2.html">&raquo;</a>
</p>
            </section><!-- /#content -->
        <section id="extras" class="body">
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <p>Powered by <a href="http://getpelican.com/">Pelican</a>. Theme <a href="https://github.com/blueicefield/pelican-blueidea/">blueidea</a>, inspired by the default theme.</p>
        </footer><!-- /#contentinfo -->

</body>
</html>